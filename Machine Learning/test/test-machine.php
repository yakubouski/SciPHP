<?php
use Sci\Math\NeuralNetwork\Machine as Machine;

$DataSet1 = [
    [   0	,   0.7	,],[   0	    ,0.5366  ],
    [   0.5	,   1	,],[   0.2647	,0.9512 ],
    [   0.7	,   0.1	,],[   0.9706	,0.122  ],
    [   0.2	,   0.6	,],[   0.2353	,0.4878  ],
    [   1	,   0.5	,],[   1	    ,0.5854  ],
    [   0.6	,   0	,],[   0.9412	,0      ],
    [   0.2	,   0.4	,],[   0.3529	,0.2927  ],
    [   0.7	,   1	,],[   0.4412	,1      ],
    [   0.9	,   0.8	,],[   0.7353	,0.8537  ],
    [   0.5	,   0.3	,],[   0.6765	,0.2683  ],
];

$DataSet =[
    [[0.378,0.431,0.616,0.612,0.557,0.512],[0,1]],
    [[0.467,0.464,0.606,0.64,0.65,0.658],[1,0]],
    [[0.177,0.224,0.457,0.573,0.556,0.512],[0,1]],
    [[0.271,0.289,0.421,0.466,0.438,0.402],[0,1]],
    [[0.433,0.506,0.74,0.725,0.665,0.618],[0,1]],
    [[0.432,0.446,0.627,0.678,0.683,0.682],[1,0]],
    [[0.464,0.501,0.74,0.795,0.796,0.793],[1,0]],
    [[0.058,0.048,0.201,0.395,0.428,0.411],[0,1]],
    [[0.685,0.682,0.87,0.881,0.915,0.957],[1,0]],
    [[0.783,0.682,0.568,0.444,0.464,0.526],[1,0]],
    [[0.455,0.481,0.667,0.694,0.682,0.673],[1,0]],
    [[0.736,0.674,0.637,0.53,0.533,0.574],[1,0]],
    [[0.302,0.498,0.904,0.85,0.69,0.554],[0,1]],
    [[0.298,0.305,0.411,0.442,0.416,0.386],[0,1]],
    [[0.446,0.33,0.329,0.458,0.569,0.65],[1,0]],
    [[0.313,0.286,0.417,0.538,0.582,0.598],[0,1]],
    [[0.001,0,0.243,0.523,0.589,0.582],[0,1]],
    [[0.354,0.316,0.264,0.21,0.168,0.142],[0,1]],
    [[0.652,0.677,0.843,0.788,0.766,0.77],[1,0]],
    [[0.22,0.18,0.308,0.486,0.551,0.571],[0,1]],
    [[0.741,0.591,0.453,0.418,0.505,0.608],[1,0]],
    [[0.443,0.391,0.516,0.647,0.73,0.784],[1,0]],
    [[0.256,0.155,0,0,0,0],[0,1]],
    [[0.467,0.431,0.522,0.575,0.611,0.638],[1,0]],
    [[0.357,0.308,0.482,0.679,0.783,0.839],[1,0]],
    [[0.211,0.165,0.205,0.305,0.329,0.326],[0,1]],
    [[0.294,0.219,0.264,0.405,0.48,0.519],[0,1]],
    [[0.323,0.33,0.512,0.614,0.633,0.63],[0,1]],
    [[0.229,0.271,0.499,0.606,0.595,0.56],[0,1]],
    [[0.524,0.629,0.872,0.773,0.668,0.599],[0,1]],
    [[1,1,1,0.719,0.642,0.655],[1,0]],
    [[0.324,0.276,0.363,0.479,0.531,0.556],[0,1]],
    [[0.724,0.593,0.457,0.393,0.449,0.531],[1,0]],
    [[0.314,0.14,0.164,0.482,0.703,0.841],[1,0]],
    [[0,0.092,0.491,0.742,0.749,0.692],[0,1]],
    [[0.143,0.062,0.14,0.374,0.478,0.519],[0,1]],
    [[0.741,0.74,0.889,0.845,0.856,0.892],[1,0]],
    [[0.569,0.635,0.956,1,1,1],[1,0]],
    [[0.588,0.442,0.39,0.489,0.62,0.732],[1,0]],
    [[0.417,0.319,0.384,0.552,0.672,0.752],[1,0]],
    [[0.223,0.333,0.618,0.647,0.56,0.471],[0,1]],
    [[0.388,0.395,0.48,0.463,0.426,0.398],[0,1]],
    [[0.165,0.105,0.214,0.435,0.525,0.557],[0,1]],
    [[0.44,0.396,0.501,0.593,0.649,0.686],[1,0]],
    [[0.325,0.227,0.325,0.556,0.696,0.778],[1,0]],
    [[0.315,0.235,0.302,0.472,0.566,0.619],[1,0]],
    [[0.415,0.53,0.843,0.829,0.747,0.679],[0,1]],
    [[0.566,0.626,0.922,0.958,0.955,0.954],[1,0]],
];

#$nn = new Machine(3,2,[3]);

$nn = new Machine(6,2,[2],[
   /*w01 = */0.03, /*w11 = */-0.08, /*w21 = */-0.06, /*w31 = */0.02, /*w41 = */0.02, /*w51 = */-0.08, /*w61 = */-0.07,
   /*w02 = */0.02, /*w12 = */-0.05, /*w22 = */-0.01, /*w32 = */0.05, /*w42 = */-.04, /*w52 = */-0.01, /*w62 = */0.01,
   /*w03 = */0.04, /*w13 = */ 0.01, /*w23 = */ 0.04,
   /*w04 = */0.07, /*w14 = */ 0.02, /*w24 = */ 0.01]);

$W = [];
$nn->Training(function($n,$epoch,$nn)use(&$DataSet){
    return $DataSet[$n];
},count($DataSet),150,0.1,2,0.5,function($n,$epoch,$nn)use(&$W){
    $W[] = $nn->getWeights();
});
/*
printTable('Dataset',[
    'w{|01}','w{|11}','w{|21}','w{|31}','w{|41}','w{|51}','w{|61}',
    'w{|02}','w{|12}','w{|22}','w{|32}','w{|42}','w{|52}','w{|62}',
    'w{|03}','w{|13}','w{|23}',
    'w{|04}','w{|14}','w{|24}',
],$W);
*/
$O = [];
$R = [];

foreach($DataSet as list($i,$o)) {
    $O[] = $o;
    $R[] = $nn->Compute($i,2.0);
}

printTable('Dataset',[
    'O{|1}','O{|2}','~Y{|1}','~Y{|2}',
],$O,$R);